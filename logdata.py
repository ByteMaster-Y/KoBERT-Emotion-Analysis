import matplotlib.pyplot as plt

# --- 학습 로그 데이터 ---
epoch = [
    0.04, 0.08, 0.12, 0.16, 0.2, 0.24, 0.28, 0.32, 0.36, 0.4,
    0.44, 0.48, 0.52, 0.56, 0.6, 0.64, 0.68, 0.72, 0.76, 0.8,
    0.84, 0.88, 0.92, 0.96, 1.0, 1.04, 1.08, 1.12, 1.16, 1.2,
    1.24, 1.28, 1.32, 1.36, 1.4, 1.44, 1.48, 1.52, 1.56, 1.6,
    1.64, 1.68, 1.72, 1.76, 1.8, 1.84, 1.88, 1.92, 1.96, 2.0
]

loss = [
    0.7183, 0.701, 0.6977, 0.6982, 0.7052, 0.7052, 0.6942, 0.6993, 0.7057, 0.7034,
    0.701, 0.703, 0.6988, 0.6942, 0.7029, 0.7005, 0.7024, 0.7029, 0.7052, 0.6936,
    0.7014, 0.6973, 0.7002, 0.6989, 0.6991, 0.6997, 0.6998, 0.6951, 0.6957, 0.6995,
    0.6975, 0.7, 0.6985, 0.6928, 0.6952, 0.6972, 0.6947, 0.6942, 0.697, 0.6963,
    0.6965, 0.6948, 0.6954, 0.6919, 0.688, 0.6889, 0.6863, 0.6838, 0.6911, 0.6718
]

grad_norm = [
    6.1303, 3.4939, 3.5683, 6.9005, 7.4941, 1.2866, 4.5368, 2.4897, 5.1382, 1.781,
    2.9988, 6.6110, 3.1988, 1.3561, 1.3598, 2.7339, 6.8208, 3.2999, 1.5816, 3.1218,
    2.0924, 1.2105, 4.0753, 7.2719, 4.7956, 7.9511, 3.9813, 4.6931, 1.1808, 5.9581,
    2.3408, 2.6404, 1.2916, 5.8363, 4.8400, 4.0651, 3.7053, 1.3948, 1.7483, 2.7252,
    2.1476, 1.0946, 1.4550, 5.2528, 4.5550, 2.1543, 4.9391, 1.3133, 1.3590, 1.9852
]

learning_rate = [
    4.901e-5, 4.801e-5, 4.701e-5, 4.601e-5, 4.501e-5, 4.401e-5, 4.301e-5, 4.201e-5, 4.101e-5, 4.001e-5,
    3.901e-5, 3.801e-5, 3.701e-5, 3.601e-5, 3.501e-5, 3.401e-5, 3.301e-5, 3.201e-5, 3.101e-5, 3.001e-5,
    2.901e-5, 2.801e-5, 2.701e-5, 2.601e-5, 2.501e-5, 2.401e-5, 2.301e-5, 2.201e-5, 2.101e-5, 2.001e-5,
    1.901e-5, 1.801e-5, 1.701e-5, 1.601e-5, 1.501e-5, 1.401e-5, 1.301e-5, 1.201e-5, 1.101e-5, 1.001e-5,
    9.01e-6, 8.01e-6, 7.01e-6, 6.01e-6, 5.01e-6, 4.01e-6, 3.01e-6, 2.01e-6, 1.01e-6, 1e-8
]

# --- 그래프 그리기 ---
fig, ax1 = plt.subplots(figsize=(12,6))

color = 'tab:blue'
ax1.set_xlabel('Epoch')
ax1.set_ylabel('Loss', color=color)
ax1.plot(epoch, loss, color=color, marker='o', label='Train Loss')
ax1.tick_params(axis='y', labelcolor=color)

ax2 = ax1.twinx()  # y축 공유
color = 'tab:red'
ax2.set_ylabel('Grad Norm', color=color)
ax2.plot(epoch, grad_norm, color=color, marker='x', label='Grad Norm')
ax2.tick_params(axis='y', labelcolor=color)

# learning rate 점선
ax2.plot(epoch, learning_rate, color='tab:green', linestyle='--', marker='s', label='Learning Rate')

fig.tight_layout()
plt.title("KoBERT Training Log (Loss, Grad Norm, LR)")
ax1.legend(loc='upper left')
ax2.legend(loc='upper right')
plt.show()
